---
title: "hw5"
author: "C-T Berezin"
date: "11/15/2021"
output: html_document
---

```{r}
library(tidyverse)
library(lubridate)
```

```{r}
#read in the data
homicides <- read.csv("../data/homicide-data.csv")
```

```{r}
#update the date columns
homicides <- homicides %>% 
  mutate(reported_date = ymd(reported_date),
         month = month(reported_date, label=TRUE)) %>%
  mutate(year_mo = format(as.Date(reported_date), "%Y-%m"),
         warm_mo = month %in% c("May", "Jun", "Jul", "Aug", "Sep", "Oct")) %>% 
  mutate(year_mo = ym(year_mo))
```

```{r}
#filter to just Baltimore
balt_homs <- homicides %>% 
  unite("Location", city:state, sep=", ") %>% 
  filter(Location == "Baltimore, MD")
```

```{r}
#count up monthly homicides in Baltimore
monthly_homs <- balt_homs %>% group_by(year_mo, warm_mo) %>% count()
```

```{r, fig.height=2, fig.width=10}
#plot the data
ggplot(monthly_homs, aes(x=year_mo)) +
  geom_histogram(aes(y=n, fill=warm_mo), stat="identity") +
  scale_x_date(name = "Date",
               date_labels = "%Y") +
  geom_vline(xintercept = as.Date("2015-04-12"),
             linetype = "dashed",
             col = "red",
             size=1.5)
```
